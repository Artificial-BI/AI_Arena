{% extends 'base.html' %}
{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/arena.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Добавляем эту строку -->
{% endblock %}

{% block content %}

<h1>Arena Interface</h1>

<!-- Arena Name -->
<h2>Magic Arena</h2>

<!-- Button to start test battle -->
<button id="start-test-battle">Start Test Battle</button>
<button id="start-tactics">Начать бой</button> <!-- Добавляем кнопку для запуска боя -->

<!-- Player Table -->
<table id="players-table">
    <thead>
        <tr>
            <th>Number</th>
            <th>Player Name/ID</th>
            <th>Character Name</th>
            <th>Character Traits</th>
            <th>Character Image</th>
        </tr>
    </thead>
    <tbody>
        {% for i, character in enumerate(characters) %}
        <tr data-traits="{{ character.traits }}">
            <td>{{ i + 1 }}</td>
            <td>{{ character.user_id }}</td>
            <td>{{ character.name }}</td>
            <td>
                <div class="chart-container">
                    <canvas id="traits-chart-{{ i + 1 }}" class="chart-canvas"></canvas>
                </div>
            </td>
            <td>
                <img src="{{ url_for('static', filename=character.image_url) }}" alt="Character Image" class="character-image" data-description="{{ character.description }}">
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Arena Chat -->
<h2>Arena Chat</h2>
<div id="arena-chat-box">
    <!-- Chat messages will be added here using JavaScript -->
</div>

<!-- Tactics AI Chat -->
<h2>Tactics AI Chat</h2>
<div id="tactics-chat-box">
    <!-- Chat messages will be added here using JavaScript -->
</div>
<form id="tactics-chat-form">
    <input type="text" id="tactics-chat-input" placeholder="Enter message...">
    <button type="submit">Send</button>
</form>

<!-- General Chat for Players, Spectators, and AI -->
<h2>General Chat</h2>
<div id="general-chat-box">
    <!-- Chat messages will be added here using JavaScript -->
</div>
<form id="general-chat-form">
    <input type="text" id="general-chat-input" placeholder="Enter message...">
    <button type="submit">Send</button>
</form>

<div id="tooltip" style="position: absolute; display: none; background: #fff; border: 1px solid #ccc; padding: 10px; border-radius: 4px;"></div>

<script>
    const user_id = "{{ g.user.id }}";
</script>
<script src="{{ url_for('static', filename='js/arena.js') }}"></script>
{% endblock %}
